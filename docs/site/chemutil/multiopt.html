<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />


  <title>chemutil.multiopt API documentation</title>
  <meta name="description" content="Module for dealing with multi objective problems. The main focus is to use Pareto front methods to i..." />


  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>

  <style type="text/css">
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}
</style>
  <style type="text/css">
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/
</style>
  <style type="text/css">
  pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #F00 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666 } /* Operator */
.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #9C6500 } /* Comment.Preproc */
.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.codehilite .gr { color: #E40000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #008400 } /* Generic.Inserted */
.codehilite .go { color: #717171 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #04D } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #687822 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */
.codehilite .no { color: #800 } /* Name.Constant */
.codehilite .nd { color: #A2F } /* Name.Decorator */
.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #00F } /* Name.Function */
.codehilite .nl { color: #767600 } /* Name.Label */
.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #BBB } /* Text.Whitespace */
.codehilite .mb { color: #666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666 } /* Literal.Number.Float */
.codehilite .mh { color: #666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #00F } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */
  </style>
  <style type="text/css">
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}
</style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>
<div id="container">




















  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3>Super-module</h3>
      <ul>
        <li class="mono"><a href="index.html">chemutil</a></li>
      </ul>
    </li>
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>

  <ul>
    <li class="mono"><a href="#chemutil.multiopt.log">log</a></li>
    <li class="mono"><a href="#chemutil.multiopt.par_eff_col_name">par_eff_col_name</a></li>
    <li class="mono"><a href="#chemutil.multiopt.par_rank_col_name">par_rank_col_name</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>

  <ul>
    <li class="mono"><a href="#chemutil.multiopt.comparison_grid_radar_plots">comparison_grid_radar_plots</a></li>
    <li class="mono"><a href="#chemutil.multiopt.filter_on_property_changes">filter_on_property_changes</a></li>
    <li class="mono"><a href="#chemutil.multiopt.get_pareto_efficient_set">get_pareto_efficient_set</a></li>
    <li class="mono"><a href="#chemutil.multiopt.get_pareto_ranking">get_pareto_ranking</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_idealized_radar_plot">plot_idealized_radar_plot</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_multi_radar_overlay">plot_multi_radar_overlay</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_multi_radar_with_standard_data">plot_multi_radar_with_standard_data</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_multi_radar_without_standard_data">plot_multi_radar_without_standard_data</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_front">plot_pareto_front</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_front_2d">plot_pareto_front_2d</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_front_3d">plot_pareto_front_3d</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_front_nd">plot_pareto_front_nd</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_rank">plot_pareto_rank</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_rank_2d">plot_pareto_rank_2d</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_rank_3d">plot_pareto_rank_3d</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_pareto_rank_nd">plot_pareto_rank_nd</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_single_radar_with_standard_data">plot_single_radar_with_standard_data</a></li>
    <li class="mono"><a href="#chemutil.multiopt.plot_single_radar_without_standard_data">plot_single_radar_without_standard_data</a></li>
    <li class="mono"><a href="#chemutil.multiopt.radar_plot">radar_plot</a></li>
    <li class="mono"><a href="#chemutil.multiopt.radar_sub_plots_pareto_front">radar_sub_plots_pareto_front</a></li>
    <li class="mono"><a href="#chemutil.multiopt.radar_sub_plots_pareto_ranking">radar_sub_plots_pareto_ranking</a></li>
    <li class="mono"><a href="#chemutil.multiopt.radar_summary_plot">radar_summary_plot</a></li>
  </ul>

    </li>


    </ul>
  </div>

<article id="content">





  <header id="section-intro">
  <h1 class="title"><span class="name">chemutil.multiopt</span> module</h1>
  <p>Module for dealing with multi objective problems. The main focus is to use Pareto front methods to identify the most promising candidates and rank.</p>

  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt" class="source">
    <div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin.env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for dealing with multi objective problems. The main focus is to use Pareto front methods to identify the most promising candidates and rank.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">paretoset</span><span class="w"> </span><span class="kn">import</span> <span class="n">paretoset</span><span class="p">,</span> <span class="n">paretorank</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">chemutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">helpers</span><span class="p">,</span> <span class="n">vis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">colors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">par_eff_col_name</span> <span class="o">=</span> <span class="s2">&quot;pareto_efficent_set&quot;</span>
<span class="n">par_rank_col_name</span> <span class="o">=</span> <span class="s2">&quot;pareto_rank&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">filter_on_property_changes</span><span class="p">(</span>
    <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">reference_properties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">experimental_properties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">change</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">must_pass</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">number_passing</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">equal_acceptable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    _summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): _description_</span>
<span class="sd">        reference_properties (List[str]): _description_</span>
<span class="sd">        experimental_properties (List[str]): _description_</span>
<span class="sd">        change (List[str]): _description_</span>
<span class="sd">        number_passing (Optional[int], optional): _description_. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Note: If using normalized data ensure that the data is normalized together otherwise the results are invalid&quot;</span>
    <span class="p">)</span>

    <span class="n">columns_add</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">equal_acceptable</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ref</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">diff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">reference_properties</span><span class="p">,</span> <span class="n">experimental_properties</span><span class="p">,</span> <span class="n">change</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;decrease&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;increase&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ref</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">diff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">reference_properties</span><span class="p">,</span> <span class="n">experimental_properties</span><span class="p">,</span> <span class="n">change</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;decrease&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;increase&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">must_pass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Must pass sums </span><span class="si">{</span><span class="n">df</span><span class="p">[[</span><span class="n">columns_add</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">must_pass</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;must pass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">columns_add</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="k">for</span> <span class="n">ith</span> <span class="ow">in</span> <span class="n">must_pass</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">must_pass</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;must pass&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">number_passing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pass sums </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">columns_add</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;passing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns_add</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">number_passing</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;passing&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_pareto_efficient_set</span><span class="p">(</span>
    <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">ignore_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">return_efficent_set_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_debug_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tmp_pareto_eff.csv&quot;</span><span class="p">,</span>
    <span class="n">_verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to derive the paraeto efficent set based on N objective column vectors and min or max optimization criteria</span>

<span class="sd">    Args:</span>
<span class="sd">        data_df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more)</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        ignore_duplicates (bool, optional): How to deal with duplicate rows, if True it keeps the first and ignores all others. Defaults to True.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        return_efficent_set_only: (bool): whether to return only the pareto efficent set or not</span>
<span class="sd">        _debug (bool): Whether to save the dataframe that is used for the pareto analysis or not. Default False.</span>
<span class="sd">        _debug_filename (str): The debug file name to save to. Default is &quot;tmp_pareto_eff.csv&quot;.</span>
<span class="sd">        _verbose (bool): Whether to log the optimal direction for each column or not</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The same as the input data_df with a boolean column appended called `pareto_efficent_set`. If `return_efficent_set_only`</span>
<span class="sd">        True then only the rows of the input data_df which are in the pareto efficent set are retruned</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_pd_column_subset</span><span class="p">(</span><span class="n">data_df</span><span class="p">,</span> <span class="n">cols_to_keep</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">_debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">_debug_filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sense</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">nam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">nam</span><span class="p">,</span> <span class="n">sense</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">ent</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
            <span class="s2">&quot;The data set has NaNs present. These cannot be automatically processed please infill, update or take out the NaNs&quot;</span>
        <span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">paretoset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">minmax</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">ignore_duplicates</span><span class="p">,</span> <span class="n">use_numba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;The Pareto efficent set contain </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="si">}</span><span class="s2"> data points out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">return_efficent_set_only</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_df</span><span class="p">[</span><span class="n">par_eff_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span>
        <span class="k">return</span> <span class="n">data_df</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_pareto_ranking</span><span class="p">(</span>
    <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">ignore_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">_debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_debug_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tmp_pareto_eff.csv&quot;</span><span class="p">,</span>
    <span class="n">_verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to derive the paraeto ranking set based on N objective column vectors and min or max optimization criteria</span>

<span class="sd">    Args:</span>
<span class="sd">        data_df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more)</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        ignore_duplicates (bool, optional): How to deal with duplicate rows, if True it keeps the first and ignores all others. Defaults to True.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        _debug (bool): Whether to save the dataframe that is used for the pareto analysis or not. Default False.</span>
<span class="sd">        _debug_filename (str): The debug file name to save to. Default is &quot;tmp_pareto_eff.csv&quot;.</span>
<span class="sd">        _verbose (bool): Whether to log the optimal direction for each column or not</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The same as the input data_df with a integer column appended called `pareto_ranks`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_pd_column_subset</span><span class="p">(</span><span class="n">data_df</span><span class="p">,</span> <span class="n">cols_to_keep</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">_debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">_debug_filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sense</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">nam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">nam</span><span class="p">,</span> <span class="n">sense</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">ranks</span> <span class="o">=</span> <span class="n">paretorank</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">minmax</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">ignore_duplicates</span><span class="p">,</span> <span class="n">use_numba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;The Pareto efficent set contain </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ranks</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2"> data points out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>

    <span class="n">data_df</span><span class="p">[</span><span class="n">par_rank_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranks</span>

    <span class="k">return</span> <span class="n">data_df</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_front.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a Pareto front in ND (Scatter plots for 2D and 3D)</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_column (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        summary_plot_type (Optional[str], optional): mean, min, max or None to plot a summary of the Pareto efficent set vs the Pareto inefficent set for N D optimzation. Defaults to None.</span>
<span class="sd">        normalization (Optional[str], optional): The normalization to use for ND radar plots. The &#39;zscale&#39; is better for data where there are outliers as each dimension is normalized to unit variance,</span>
<span class="sd">        but each dimension has its own scale. The &#39;minmax&#39; scaling places each dimesion on a normalized [0, 1] scale but maintains the skew of outliers. None uses raw data which can be hard to</span>
<span class="sd">        interpret when dimesnions have very different scales.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes on N dimensional radar plots, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If a mismatched number of minmax and objective columns are provided</span>
<span class="sd">        UserWarning: If a user provides a singlar objective (i.e 1D) for which the Pareto solution is min(singular_objective_vect) or max(singular_objective_vect) and</span>
<span class="sd">        there is no need for using the Pareto method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ensure not adding to the original</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Use/assume the defualt name if none given</span>
    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make sure tehre is a pareto efficent column</span>
    <span class="k">if</span> <span class="n">par_eff_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Determining pareto efficent set as column not found in the currently passed in dataframe&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">get_pareto_efficient_set</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">minmax</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">return_efficent_set_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Pick the right plotting function</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 2D Pareto front&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_front_2d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 3D Pareto front&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_front_3d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">plot_pareto_front_nd</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">summary_plot_type</span><span class="o">=</span><span class="n">summary_plot_type</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">eff_eolutions_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
            <span class="s2">&quot;Number of objective columns is singular more than one objective should be used&quot;</span>
        <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front_2d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 2D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">par_eff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">par_ineff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto inefficent&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto efficent (optimal)&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns: </span><span class="si">{</span><span class="n">par_eff_df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Pareto optimal (efficent) set includes:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">label_col</span><span class="p">]):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> y: </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> lab: </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="n">lab</span><span class="p">,</span>
                <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Front&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">inchi</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front_3d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="n">xpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">ypad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">zpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">boxpad</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="n">xlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">ylabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">zlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 3D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
    <span class="n">par_eff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">par_ineff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto inefficent&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto efficent (optimal)&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">xlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">ylabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">ypad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">zlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">zpad</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Pareto optimal (efficent) set includes:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">label_col</span><span class="p">]):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> y: </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> z: </span><span class="si">{</span><span class="n">z</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> lab: </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">lab</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Front&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="n">boxpad</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">inchi</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front_nd</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_nd.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot an N dimensional pareto front on a radar plot. This is plotted by normalizeding all properties to a [0, 1] scale using min max normalization. Typically we summarize these by the mean, max or min of the inefficent set Vs the efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        summay_plot_type (Union[str, None], optional): the summary type mean, min or max of each objective for each set (inefficent and efficent). Defaults to &quot;mean&quot;.</span>
<span class="sd">        normalization (Optional[str]): string name of normalization method or None to use raw data. Defaults to &quot;zscale&quot;.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserWarning: if an unrecognized summary plot type is given</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">summary_plot_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">summary_plot_df</span> <span class="o">=</span> <span class="n">radar_summary_plot</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">summary_type</span><span class="o">=</span><span class="n">summary_plot_type</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">summary_plot_df</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">radar_sub_plots_pareto_front</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">eff_eolutions_df</span>


<span class="k">def</span><span class="w"> </span><span class="nf">radar_sub_plots_pareto_front</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;subplot_pareto.png&quot;</span><span class="p">,</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">return_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_y_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a radar plot of the normalized (min max normalization) mean for each property over the inefficent and efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        ddf (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): The column that defines the molecules labels.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        normalization (Union[str, None]): string defining teh normalization method</span>
<span class="sd">        legend_pos (str): legend position string for matplotlib</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>
<span class="sd">        y_ticks (Optional[Union[np.ndarray, list]], optional): Set of y ticks to use to allow for comparison across sets. Defaults as None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: saves plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the column containing the Pareto efficent labels as bools</span>
    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Assuming Pareto efficent bool column is </span><span class="si">{</span><span class="n">par_eff_col_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataframe input has shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get the metric columns only and normalize as requested</span>
    <span class="n">metric_assay_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># min max scale</span>
        <span class="k">if</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Min max scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_min_max_scale</span><span class="p">(</span>
                <span class="n">metric_assay_df</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min max scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

        <span class="c1"># z scale</span>
        <span class="k">elif</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;zscale&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Z scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_z_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consistent_scale</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before scaling the data frame is </span><span class="si">{</span><span class="n">metric_assay_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;After scaling the data frame is </span><span class="si">{</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                        <span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto (z) scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="c1"># No scaling - ill advised</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Will not scale data within this method. You should pre-scale your data.&quot;</span>
        <span class="p">)</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">metric_assay_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unscaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># get whether a molecule is an efficent solution</span>
    <span class="n">efficent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">efficent</span><span class="p">)</span><span class="si">}</span><span class="s2"> Pareto efficent solutions in the input data&quot;</span><span class="p">)</span>

    <span class="c1"># Get the mean of the Pareto inefficent solutions as a background</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="c1"># Get the normalized efficent solutions one per row</span>
    <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">])</span>

    <span class="c1"># set the layout assuming 5 columns asa default</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mols_per_row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mols_per_row</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">m_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">%</span> <span class="n">mols_per_row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span>
        <span class="n">m_columns</span> <span class="o">=</span> <span class="n">mols_per_row</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span><span class="p">))</span>
        <span class="n">m_columns</span> <span class="o">=</span> <span class="n">mols_per_row</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">label_col</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ith</span><span class="p">)</span>

        <span class="c1"># plot mean of inefficent set as the background</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Inefficent set mean&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># plot the efficent row example</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Efficent solution </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Inefficent Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="c1"># for if structures are given as smiles or inchi</span>
        <span class="n">efficent_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;efficent_molecules_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d_</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">inefficent_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;inefficent_molecules_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d_</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the smiles from is </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the smiles from columns are </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Efficent molecules images in file </span><span class="si">{</span><span class="n">efficent_filename</span><span class="si">}</span><span class="s2"> inefficent molecules images in file </span><span class="si">{</span><span class="n">inefficent_filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the inchi from is </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the inchi from columns are </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Efficent molecules images in file </span><span class="si">{</span><span class="n">efficent_filename</span><span class="si">}</span><span class="s2"> inefficent molecules images in file </span><span class="si">{</span><span class="n">inefficent_filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">_get_radar_subplot_data</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">eff_eolutions_df</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_radar_subplot_data</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to get the raw data used for the radar plot of the Pareto efficent set for each property compared to the mean over the inefficent  set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): The column that defines the molecules labels.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The data for the efficent set compared to the mean of the inefficent set</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the column containing the Pareto efficent labels as bools</span>
    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Assuming Pareto efficent bool column is </span><span class="si">{</span><span class="n">par_eff_col_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataframe input has shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Get the metric columns only but don&#39;t normalize here as we want to return teh raw data</span>
    <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># get whether a molecule is an efficent solution</span>
    <span class="n">efficent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">efficent</span><span class="p">)</span><span class="si">}</span><span class="s2"> Pareto efficent solutions in the input data&quot;</span><span class="p">)</span>

    <span class="c1"># Get the mean of the Pareto inefficent solutions as a background</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="c1"># Get the normalized efficent solutions one per row</span>
    <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">])</span>

    <span class="c1"># Prepare for return dataframe with expected columns</span>
    <span class="n">eff_solutions_lists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">struct_col</span> <span class="o">=</span> <span class="n">smiles_column</span>
        <span class="n">eff_solutions_lists_header</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;smiles&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Mean_ineff_</span><span class="si">{</span><span class="n">ent</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">ent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">struct_col</span> <span class="o">=</span> <span class="n">smiles_column</span>
        <span class="n">eff_solutions_lists_header</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;inchi&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Mean_ineff_</span><span class="si">{</span><span class="n">ent</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">ent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">struct_col</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">eff_solutions_lists_header</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Mean_ineff_</span><span class="si">{</span><span class="n">ent</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">ent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting data as dataframe .....&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">label_col</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ith</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">struct_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_struct</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">struct_col</span><span class="p">]</span>

        <span class="c1"># Gather the data together for a return dataframe</span>
        <span class="k">if</span> <span class="n">struct_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eff_solutions_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">lab</span><span class="p">,</span> <span class="n">str_struct</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eff_solutions_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">lab</span><span class="p">]</span> <span class="o">+</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Efficent solution list of lists: </span><span class="si">{</span><span class="n">eff_solutions_lists</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Efficent solution dataframe headers: </span><span class="si">{</span><span class="n">eff_solutions_lists_header</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">eff_solutions_lists</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">eff_solutions_lists_header</span>
    <span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Efficent solution dataframe: </span><span class="si">{</span><span class="n">eff_eolutions_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">eff_eolutions_df</span>


<span class="k">def</span><span class="w"> </span><span class="nf">radar_summary_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">summary_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_y_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a radar plot of the normalized data using one of mean, median, max or min summary methods for each property over the inefficent and efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        normalization (Union[str, None]): The normalization type to use or None to use the raw data. Default is zscale.</span>
<span class="sd">        summary_type (str): the type of summary statistic to use out of mean. median, max and min. Default is mean.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        y_ticks (Optional[Union[np.ndarray, List[float]]], optional): Defined set of y tickmarks values to use</span>
<span class="sd">        show_y_ticks (bool): Show z scaled y values. Default is False</span>
<span class="sd">        legend_pos: (Union[int, str]): where to put the legend see https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html. Defaults to 0 best.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: saves plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get the metric columns only and normalize as requested</span>
    <span class="n">metric_assay_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># min max scale</span>
        <span class="k">if</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Min max scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_min_max_scale</span><span class="p">(</span>
                <span class="n">metric_assay_df</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min max scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
        <span class="c1"># z scale</span>
        <span class="k">elif</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;zscale&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Z scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_z_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consistent_scale</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before scaling the data frame is </span><span class="si">{</span><span class="n">metric_assay_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;After scaling the data frame is </span><span class="si">{</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                        <span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto (z) scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="c1"># No scaling - ill advised</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Will not perform scaling within the function. You should pre-scale your data.&quot;</span>
        <span class="p">)</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">metric_assay_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="p">),</span>
                <span class="nb">max</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="p">),</span>
                <span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unscaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">efficent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;median&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unknown summary type &#39;</span><span class="si">{</span><span class="n">summary_type</span><span class="si">}</span><span class="s2">&#39; (type is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">summary_type</span><span class="p">)</span><span class="si">}</span><span class="s2">), please give one of: &#39;mean&#39;, &#39;median&#39;, &#39;min&#39; or &#39;max&#39;&quot;</span>
        <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inefficent set </span><span class="si">{</span><span class="n">summary_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Efficent set </span><span class="si">{</span><span class="n">summary_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inefficent Set Vs. </span><span class="si">{</span><span class="n">summary_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Efficent Set&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span> <span class="n">width</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">y_labels</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">plot_df</span>


<span class="c1">######################################################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################################################</span>
<span class="c1">################################################################## PARETO RANKING PLOTTING FUNCTIONS #################################################################################</span>
<span class="c1">######################################################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################################################</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_ranks.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">colour_map</span><span class="o">=</span><span class="s2">&quot;bwr_r&quot;</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a Pareto front in ND (Scatter plots for 2D and 3D)</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_column (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_rank_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        summary_plot_type (Optional[str], optional): mean, min, max or None to plot a summary of the Pareto efficent set vs the Pareto inefficent set for N D optimzation. Defaults to None.</span>
<span class="sd">        normalization (Optional[str], optional): The normalization to use for ND radar plots. The &#39;zscale&#39; is better for data where there are outliers as each dimension is normalized to unit variance,</span>
<span class="sd">        but each dimension has its own scale. The &#39;minmax&#39; scaling places each dimesion on a normalized [0, 1] scale but maintains the skew of outliers. None uses raw data which can be hard to</span>
<span class="sd">        interpret when dimesnions have very different scales.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes on N dimensional radar plots, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If a mismatched number of minmax and objective columns are provided</span>
<span class="sd">        UserWarning: If a user provides a singlar objective (i.e 1D) for which the Pareto solution is min(singular_objective_vect) or max(singular_objective_vect) and</span>
<span class="sd">        there is no need for using the Pareto method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ensure not adding to the original</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Use/assume the defualt name if none given</span>
    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make sure tehre is a pareto efficent column</span>
    <span class="k">if</span> <span class="n">par_eff_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Determining pareto ranks set as column not found in the currently passed in dataframe&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">get_pareto_ranking</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">minmax</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Pick the right plotting function</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 2D Pareto ranks&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_rank_2d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">colour_map</span><span class="o">=</span><span class="n">colour_map</span><span class="p">,</span>
            <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 3D Pareto ranks&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_rank_3d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">colour_map</span><span class="o">=</span><span class="n">colour_map</span><span class="p">,</span>
            <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">plot_pareto_rank_nd</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
            <span class="n">summary_plot_type</span><span class="o">=</span><span class="n">summary_plot_type</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
            <span class="s2">&quot;Number of objective columns is singular more than one objective should be used&quot;</span>
        <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank_2d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colour_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bwr_r&quot;</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 2D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_rank_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
        <span class="n">colormap</span><span class="o">=</span><span class="n">colour_map</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto Ranking&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Ranking&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank_3d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colour_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bwr_r&quot;</span><span class="p">,</span>
    <span class="n">xpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">ypad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">zpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">boxpad</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="n">xlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">ylabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">zlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 3D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colour_map</span><span class="p">)</span>
    <span class="n">cmap_norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">scalable_cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">cmap_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">scalable_cmap</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto ranking&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">xlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">ylabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">ypad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">zlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">zpad</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Ranking&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="n">boxpad</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank_nd</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_nd.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot an N dimensional pareto front on a radar plot. This is plotted by normalizeding all properties to a [0, 1] scale using min max normalization. Typically we summarize these by the mean, max or min of the inefficent set Vs the efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        summay_plot_type (Union[str, None], optional): the summary type mean, min or max of each objective for each set (inefficent and efficent). Defaults to &quot;mean&quot;.</span>
<span class="sd">        normalization (Optional[str]): string name of normalization method or None to use raw data. Defaults to &quot;zscale&quot;.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserWarning: if an unrecognized summary plot type is given</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">radar_sub_plots_pareto_ranking</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span>
        <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">,</span>
        <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
        <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
        <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
        <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
        <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">radar_sub_plots_pareto_ranking</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;subplot_pareto_ranks.png&quot;</span><span class="p">,</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a radar plot of the normalized (zscale) mean for each property over the inefficent and the values for each molecule</span>

<span class="sd">    Args:</span>
<span class="sd">        ddf (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;subplot_pareto_ranks.png&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): The column that defines the molecules labels.</span>
<span class="sd">        pareto_rank_col (Optional[str], optional): column header for the column that defines a molecules Pareto rank (int column). Defaults to None.</span>
<span class="sd">        normalization (Union[str, None]): string defining teh normalization method</span>
<span class="sd">        legend_pos (str): legend position string for matplotlib</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: saves plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set teh column containing the Pareto efficent labels as bools</span>
    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Assuming Pareto rank int column is </span><span class="si">{</span><span class="n">par_rank_col_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataframe input has shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get the metric columns only and normalize as requested</span>
    <span class="n">metric_assay_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># min max scale</span>
        <span class="k">if</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Min max scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_rank_df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_min_max_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
        <span class="c1"># z scale</span>
        <span class="k">elif</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;zscale&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Z scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_rank_df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_z_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consistent_scale</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before scaling the data frame is </span><span class="si">{</span><span class="n">metric_assay_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After scaling the data frame is </span><span class="si">{</span><span class="n">pareto_rank_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">pareto_rank_df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">pareto_rank_df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># [f&quot;{ent:.2f}&quot; for ent in y_ticks]</span>

    <span class="c1"># No scaling - ill advised</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Using un-normalized property values&quot;</span><span class="p">)</span>
        <span class="n">pareto_rank_df</span> <span class="o">=</span> <span class="n">metric_assay_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="c1"># At the end of this:</span>
    <span class="c1">#   df is the raw input dataframe</span>
    <span class="c1">#   metric_assay_df is a copy of the same dataframe but a subset of the columns i.e. only the objective columns</span>
    <span class="c1">#   pareto_rank_df is a copy of the metric_assay dataframe but scaled values</span>

    <span class="c1"># Get the mean of the Pareto inefficent solutions (those with a rank over 1) as a background</span>
    <span class="c1"># log.info(df.dtypes)</span>
    <span class="c1"># log.info(df)</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">pareto_rank_df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">][</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="c1"># loop over the unique classes of the Pareto ranking an make a figure for each</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mols_per_row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of chosen df: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># set the layout assuming 5 columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mols_per_row</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There&#39;re less than </span><span class="si">{</span><span class="n">mols_per_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">m_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">%</span> <span class="n">mols_per_row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There&#39;re are a multiple of </span><span class="si">{</span><span class="n">mols_per_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span>
            <span class="n">m_columns</span> <span class="o">=</span> <span class="mi">5</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There&#39;re are not a multiple of </span><span class="si">{</span><span class="n">mols_per_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span><span class="p">))</span>
            <span class="n">m_columns</span> <span class="o">=</span> <span class="n">mols_per_row</span>

        <span class="c1"># Set the overall figure per group</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;for Pareto ranking </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2"> there are n rows: </span><span class="si">{</span><span class="n">n_rows</span><span class="si">}</span><span class="s2"> m columns: </span><span class="si">{</span><span class="n">m_columns</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># log.info(chosen_df)</span>

        <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
        <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lab</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">label_col</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ith</span><span class="p">)</span>

            <span class="c1"># plot mean of inefficent set as the background</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Inefficent set mean&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># plot the efficent row example</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2"> solution </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Inefficent Vs.</span><span class="se">\n</span><span class="s2">Rank </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                    <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                    <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                    <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
                <span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># save the plot and tidy up</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">savep</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">savep</span><span class="o">.</span><span class="n">stem</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">savep</span><span class="o">.</span><span class="n">suffix</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>


<span class="c1">######################################################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################################################</span>
<span class="c1">################################################################## COMPARISON RADAR PLOTS AND ONE OFFS ###############################################################################</span>
<span class="c1">######################################################################################################################################################################################</span>
<span class="c1">######################################################################################################################################################################################</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_single_radar_without_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;single_radar_without_standard.png&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot for a single experimental</span>
<span class="sd">    datapoint i.e. will only plot the first row of the experimental dataframes</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_labels (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">y_labels</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_single_radar_with_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">standard_plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;single_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot for a single experimental and standard</span>
<span class="sd">    datapoint i.e. will only plot the first row of the experimental and standard dataframes</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># base check that the columns are teh same length</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_number_of_columns</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># base check that the columns have the same names</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_column_names</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_label</span><span class="si">}</span><span class="s2"> Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">y_labels</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_radar_with_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">standard_plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multi_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">experimental_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules</span>
<span class="sd">    (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each  of the subplots as a coparison point that is consistent</span>
<span class="sd">    over the sub plots.</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>
<span class="sd">        mols_per_row: int: The number of molecule to plot in a sub plot row. Defaults to 5.</span>
<span class="sd">        experimental_label (Optional[str], optional): List of labels for each row (moleucle) of the experimantal dataframe. Defaults to None.</span>
<span class="sd">        standard_labels (Optional[str], optional): List of labels for each row (moleucle) of the standard dataframe. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># base check that the columns are teh same length</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_number_of_columns</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># base check that the columns have the same names</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_column_names</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">n_rows</span><span class="p">,</span> <span class="n">m_columns</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_grid_layout</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span>
    <span class="p">)</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="c1">#### STANDARD PLOTTING</span>
        <span class="c1"># normalize item number values to colormap</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="c1"># Loop over the standards if there are multiple</span>
        <span class="k">for</span> <span class="n">jth</span><span class="p">,</span> <span class="n">standard_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">standard_idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">standard_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">standard_label</span> <span class="o">=</span> <span class="n">standard_labels</span><span class="p">[</span><span class="n">jth</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="c1"># colour map that should not overlap with Experimental red default</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">standard_colour</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">terrain</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">jth</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># For the title of the plot</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standards&quot;</span>

        <span class="c1">##### EXPERIMENTAL PLOTTING</span>
        <span class="k">if</span> <span class="n">experimental_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">experimental_labels</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">experimental_label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_label</span><span class="si">}</span><span class="s2"> Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_radar_without_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multi_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">experimental_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules</span>
<span class="sd">    (row in df dataframe).</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_labels (Optional[List[float]], optional): List of radial (y) ticks label values. Defaults to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>
<span class="sd">        mols_per_row (int): The number of molecules to plot per row. Defaults to 5.</span>
<span class="sd">        experimental_label (Optional[str], optional): List of labels for each row (moleucle). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">n_rows</span><span class="p">,</span> <span class="n">m_columns</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_grid_layout</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span>
    <span class="p">)</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="c1">##### EXPERIMENTAL PLOTTING</span>
        <span class="k">if</span> <span class="n">experimental_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">experimental_labels</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">experimental_label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_radar_overlay</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">standard_plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multi_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">experimental_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules</span>
<span class="sd">    (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each  of the subplots as a coparison point that is consistent</span>
<span class="sd">    over the sub plots.</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>
<span class="sd">        mols_per_row: int: The number of molecule to plot in a sub plot row. Defaults to 5.</span>
<span class="sd">        experimental_label (Optional[str], optional): List of labels for each row (moleucle) of the experimantal dataframe. Defaults to None.</span>
<span class="sd">        standard_labels (Optional[str], optional): List of labels for each row (moleucle) of the standard dataframe. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># base check that the columns are teh same length</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_number_of_columns</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># base check that the columns have the same names</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_column_names</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">n_rows</span><span class="p">,</span> <span class="n">m_columns</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_grid_layout</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span>
    <span class="p">)</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="c1">#### STANDARD PLOTTING</span>
        <span class="c1"># normalize item number values to colormap</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="c1"># Loop over the standards if there are multiple</span>
        <span class="k">for</span> <span class="n">jth</span><span class="p">,</span> <span class="n">standard_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">standard_idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">standard_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">standard_label</span> <span class="o">=</span> <span class="n">standard_labels</span><span class="p">[</span><span class="n">jth</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="c1"># colour map that should not overlap with Experimental red default</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">standard_colour</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">terrain</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">jth</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># For the title of the plot</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standards&quot;</span>

        <span class="c1">##### EXPERIMENTAL PLOTTING</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

        <span class="c1"># colour map that should not overlap with Experimental red default</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">experimental_colour</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">autumn</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">ith</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">experimental_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">experimental_labels</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">experimental_label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_label</span><span class="si">}</span><span class="s2"> Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">radar_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">df_standard</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_unique_identifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_unique_identifer_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;radar_plot.png&quot;</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">show_y_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. There is no automated scaling in this function as in the analysis based functions above</span>
<span class="sd">    this is just to plot the data. Having this separated allows for flexibility in plotting for example MMP series. This funtion will make a single plot</span>
<span class="sd">    of subplots one for each experimental molecules (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each</span>
<span class="sd">    of the subplots as a coparison point that is consistent over the sub plots.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        objective_columns (Optional[List[str, int]], optional): The columns to use as the objectives if not given assumes all columns are objective columns. Defaults to None.</span>
<span class="sd">        df_standard (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        standard_unique_identifier (Optional[str], optional): Column name in standard dataframe to identify a molecule. Defaults to None.</span>
<span class="sd">        standard_unique_identifer_column (Optional[str], optional): Column name in experimental dataframe to identify a molecule. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        label_column (Optional[Union[str, int]], optional): Column name in experimental and standard  dataframe to give a label a molecule. Defaults to None.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        show_y_ticks (bool, optional): Bool True show the radial y_tick values False don&#39;t show them. Defaults to False.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If objective columns is None not given assume all query/experimental columns are objective columns</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Get the standard data if there is standard data and extract the objective columns for plotting</span>
    <span class="c1"># if there is a stanard df provoided</span>
    <span class="k">if</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using standard data frame</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}{</span><span class="n">df_standard</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">standard_plot_df</span> <span class="o">=</span> <span class="n">df_standard</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span>

    <span class="c1"># if the standard data need to be taken out of a dataframe</span>
    <span class="k">elif</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">standard_unique_identifer_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If the standard data is part of the main data frame copy it and delete it</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">df_standard</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">extract_and_remove_row_from_df</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">standard_unique_identifer_column</span><span class="o">=</span><span class="n">standard_unique_identifer_column</span><span class="p">,</span>
            <span class="n">standard_unique_identifier</span><span class="o">=</span><span class="n">standard_unique_identifier</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using row from main df as the standard </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}{</span><span class="n">df_standard</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">standard_plot_df</span> <span class="o">=</span> <span class="n">df_standard</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span>
    <span class="c1"># if there is no standard data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No standard provided will plot just the objective functions&quot;</span><span class="p">)</span>
        <span class="n">standard_plot_df</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Get the plot data for the experimental points</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">label_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label_column</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="n">df_standard</span><span class="p">[</span><span class="n">label_column</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># set the y ticks if they are not given</span>
    <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="nb">min</span><span class="p">(</span>
                <span class="n">df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="p">),</span>
            <span class="nb">max</span><span class="p">(</span>
                <span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="p">),</span>
            <span class="mi">5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">standard_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span>
        <span class="k">if</span> <span class="n">experimental_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span>

        <span class="k">if</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_single_radar_with_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">standard_label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">standard_colour</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_single_radar_without_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">standard_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span>
        <span class="k">if</span> <span class="n">experimental_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span>

        <span class="k">if</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_multi_radar_with_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">standard_label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">standard_colour</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="n">experimental_labels</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">standard_labels</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_multi_radar_without_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">comparison_grid_radar_plots</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
    <span class="n">df_standard</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># if not given and standard idenitifer not given then only plot the objective columns</span>
    <span class="n">standard_unique_identifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_unique_identifer_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># TODO</span>
    <span class="k">pass</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_idealized_radar_plot</span><span class="p">(</span>
    <span class="n">min_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">max_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">objectives</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_labels</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Best&quot;</span><span class="p">,</span> <span class="s2">&quot;Worst&quot;</span><span class="p">),</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;illustrtaion_idelaized_pareto_front_radar_plot.png&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot an idelaized radar plot</span>

<span class="sd">    Args:</span>
<span class="sd">        min_value (float, optional): The minimum value for the plot. Defaults to 0.1.</span>
<span class="sd">        max_value (float, optional): The maximum value for the plot. Defaults to 1.0.</span>
<span class="sd">        objectives (Optional[List[str]]): List of objetcives to use</span>
<span class="sd">        filename (str, optional): file name to save to. Defaults to &quot;illustrtaion_idelaized_pareto_front_radar_plot.png&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Objective 1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 6&quot;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">],</span>
            <span class="p">[</span><span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">objectives</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">objectives</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">330</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_theta_direction</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Illustrative Radar Pareto Front Plot</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">+</span> <span class="p">(</span><span class="n">min_value</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)],</span>
        <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="chemutil.multiopt.log" class="name">var <span class="ident">log</span></p>


  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="chemutil.multiopt.par_eff_col_name" class="name">var <span class="ident">par_eff_col_name</span></p>


  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="chemutil.multiopt.par_rank_col_name" class="name">var <span class="ident">par_rank_col_name</span></p>


  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>

  <div class="item">
    <div class="name def" id="chemutil.multiopt.comparison_grid_radar_plots">
    <p>def <span class="ident">comparison_grid_radar_plots</span>(</p><p>df, objective_columns: List[Union[int, str]], df_standard: Optional[pandas.core.frame.DataFrame] = None, standard_unique_identifier: Optional[str] = None, standard_unique_identifer_column: Optional[str] = None)</p>
    </div>




  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.comparison_grid_radar_plots', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.comparison_grid_radar_plots" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">comparison_grid_radar_plots</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
    <span class="n">df_standard</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># if not given and standard idenitifer not given then only plot the objective columns</span>
    <span class="n">standard_unique_identifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_unique_identifer_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># TODO</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.filter_on_property_changes">
    <p>def <span class="ident">filter_on_property_changes</span>(</p><p>data_df: pandas.core.frame.DataFrame, reference_properties: List[str], experimental_properties: List[str], change: List[str], must_pass: List[int], number_passing: Optional[int] = None, equal_acceptable: bool = False)</p>
    </div>




    <div class="desc"><p><em>summary</em></p>
<p>Args:
    df (pd.DataFrame): <em>description</em>
    reference_properties (List[str]): <em>description</em>
    experimental_properties (List[str]): <em>description</em>
    change (List[str]): <em>description</em>
    number_passing (Optional[int], optional): <em>description</em>. Defaults to None.</p>
<p>Returns:
    pd.DataFrame: <em>description</em></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.filter_on_property_changes', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.filter_on_property_changes" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">filter_on_property_changes</span><span class="p">(</span>
    <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">reference_properties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">experimental_properties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">change</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">must_pass</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">number_passing</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">equal_acceptable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    _summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): _description_</span>
<span class="sd">        reference_properties (List[str]): _description_</span>
<span class="sd">        experimental_properties (List[str]): _description_</span>
<span class="sd">        change (List[str]): _description_</span>
<span class="sd">        number_passing (Optional[int], optional): _description_. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Note: If using normalized data ensure that the data is normalized together otherwise the results are invalid&quot;</span>
    <span class="p">)</span>

    <span class="n">columns_add</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">equal_acceptable</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ref</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">diff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">reference_properties</span><span class="p">,</span> <span class="n">experimental_properties</span><span class="p">,</span> <span class="n">change</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;decrease&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;increase&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ref</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">diff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">reference_properties</span><span class="p">,</span> <span class="n">experimental_properties</span><span class="p">,</span> <span class="n">change</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;decrease&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> DECREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;increase&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">exp</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ref</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">columns_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> INCREASED OR EQUAL compared to </span><span class="si">{</span><span class="n">ref</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">must_pass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Must pass sums </span><span class="si">{</span><span class="n">df</span><span class="p">[[</span><span class="n">columns_add</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">must_pass</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;must pass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">columns_add</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="k">for</span> <span class="n">ith</span> <span class="ow">in</span> <span class="n">must_pass</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">must_pass</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;must pass&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">number_passing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pass sums </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">columns_add</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;passing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns_add</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">number_passing</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;passing&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.get_pareto_efficient_set">
    <p>def <span class="ident">get_pareto_efficient_set</span>(</p><p>data_df: pandas.core.frame.DataFrame, minmax: List[str], ignore_duplicates: bool = True, objective_columns: Union[List[str], str] = &#39;all&#39;, return_efficent_set_only: bool = False, _debug: bool = False, _debug_filename: str = &#39;tmp_pareto_eff.csv&#39;, _verbose: bool = True)</p>
    </div>




    <div class="desc"><p>Function to derive the paraeto efficent set based on N objective column vectors and min or max optimization criteria</p>
<p>Args:
    data_df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more)
    minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns
    ignore_duplicates (bool, optional): How to deal with duplicate rows, if True it keeps the first and ignores all others. Defaults to True.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    return_efficent_set_only: (bool): whether to return only the pareto efficent set or not
    _debug (bool): Whether to save the dataframe that is used for the pareto analysis or not. Default False.
    _debug_filename (str): The debug file name to save to. Default is "tmp_pareto_eff.csv".
    _verbose (bool): Whether to log the optimal direction for each column or not</p>
<p>Returns:
    pd.DataFrame: The same as the input data_df with a boolean column appended called <code>pareto_efficent_set</code>. If <code>return_efficent_set_only</code>
    True then only the rows of the input data_df which are in the pareto efficent set are retruned</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.get_pareto_efficient_set', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.get_pareto_efficient_set" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_pareto_efficient_set</span><span class="p">(</span>
    <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">ignore_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">return_efficent_set_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_debug_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tmp_pareto_eff.csv&quot;</span><span class="p">,</span>
    <span class="n">_verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to derive the paraeto efficent set based on N objective column vectors and min or max optimization criteria</span>

<span class="sd">    Args:</span>
<span class="sd">        data_df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more)</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        ignore_duplicates (bool, optional): How to deal with duplicate rows, if True it keeps the first and ignores all others. Defaults to True.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        return_efficent_set_only: (bool): whether to return only the pareto efficent set or not</span>
<span class="sd">        _debug (bool): Whether to save the dataframe that is used for the pareto analysis or not. Default False.</span>
<span class="sd">        _debug_filename (str): The debug file name to save to. Default is &quot;tmp_pareto_eff.csv&quot;.</span>
<span class="sd">        _verbose (bool): Whether to log the optimal direction for each column or not</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The same as the input data_df with a boolean column appended called `pareto_efficent_set`. If `return_efficent_set_only`</span>
<span class="sd">        True then only the rows of the input data_df which are in the pareto efficent set are retruned</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_pd_column_subset</span><span class="p">(</span><span class="n">data_df</span><span class="p">,</span> <span class="n">cols_to_keep</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">_debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">_debug_filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sense</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">nam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">nam</span><span class="p">,</span> <span class="n">sense</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">ent</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
            <span class="s2">&quot;The data set has NaNs present. These cannot be automatically processed please infill, update or take out the NaNs&quot;</span>
        <span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">paretoset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">minmax</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">ignore_duplicates</span><span class="p">,</span> <span class="n">use_numba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;The Pareto efficent set contain </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="si">}</span><span class="s2"> data points out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">return_efficent_set_only</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_df</span><span class="p">[</span><span class="n">par_eff_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span>
        <span class="k">return</span> <span class="n">data_df</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.get_pareto_ranking">
    <p>def <span class="ident">get_pareto_ranking</span>(</p><p>data_df: pandas.core.frame.DataFrame, minmax: List[str], ignore_duplicates: bool = True, objective_columns: Union[List[str], str] = &#39;all&#39;, _debug: bool = False, _debug_filename: str = &#39;tmp_pareto_eff.csv&#39;, _verbose: bool = True)</p>
    </div>




    <div class="desc"><p>Function to derive the paraeto ranking set based on N objective column vectors and min or max optimization criteria</p>
<p>Args:
    data_df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more)
    minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns
    ignore_duplicates (bool, optional): How to deal with duplicate rows, if True it keeps the first and ignores all others. Defaults to True.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    _debug (bool): Whether to save the dataframe that is used for the pareto analysis or not. Default False.
    _debug_filename (str): The debug file name to save to. Default is "tmp_pareto_eff.csv".
    _verbose (bool): Whether to log the optimal direction for each column or not</p>
<p>Returns:
    pd.DataFrame: The same as the input data_df with a integer column appended called <code>pareto_ranks</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.get_pareto_ranking', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.get_pareto_ranking" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_pareto_ranking</span><span class="p">(</span>
    <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">ignore_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">_debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">_debug_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tmp_pareto_eff.csv&quot;</span><span class="p">,</span>
    <span class="n">_verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to derive the paraeto ranking set based on N objective column vectors and min or max optimization criteria</span>

<span class="sd">    Args:</span>
<span class="sd">        data_df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more)</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        ignore_duplicates (bool, optional): How to deal with duplicate rows, if True it keeps the first and ignores all others. Defaults to True.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        _debug (bool): Whether to save the dataframe that is used for the pareto analysis or not. Default False.</span>
<span class="sd">        _debug_filename (str): The debug file name to save to. Default is &quot;tmp_pareto_eff.csv&quot;.</span>
<span class="sd">        _verbose (bool): Whether to log the optimal direction for each column or not</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The same as the input data_df with a integer column appended called `pareto_ranks`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_pd_column_subset</span><span class="p">(</span><span class="n">data_df</span><span class="p">,</span> <span class="n">cols_to_keep</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">_debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">_debug_filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sense</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">nam</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">nam</span><span class="p">,</span> <span class="n">sense</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">ranks</span> <span class="o">=</span> <span class="n">paretorank</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">minmax</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="n">ignore_duplicates</span><span class="p">,</span> <span class="n">use_numba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;The Pareto efficent set contain </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ranks</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2"> data points out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>

    <span class="n">data_df</span><span class="p">[</span><span class="n">par_rank_col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranks</span>

    <span class="k">return</span> <span class="n">data_df</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_idealized_radar_plot">
    <p>def <span class="ident">plot_idealized_radar_plot</span>(</p><p>min_value: float = 0.1, max_value: float = 1.0, objectives: Optional[List[str]] = None, legend_labels=(&#39;Best&#39;, &#39;Worst&#39;), filename: str = &#39;illustrtaion_idelaized_pareto_front_radar_plot.png&#39;)</p>
    </div>




    <div class="desc"><p>Plot an idelaized radar plot</p>
<p>Args:
    min_value (float, optional): The minimum value for the plot. Defaults to 0.1.
    max_value (float, optional): The maximum value for the plot. Defaults to 1.0.
    objectives (Optional[List[str]]): List of objetcives to use
    filename (str, optional): file name to save to. Defaults to "illustrtaion_idelaized_pareto_front_radar_plot.png".</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_idealized_radar_plot', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_idealized_radar_plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_idealized_radar_plot</span><span class="p">(</span>
    <span class="n">min_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">max_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">objectives</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_labels</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Best&quot;</span><span class="p">,</span> <span class="s2">&quot;Worst&quot;</span><span class="p">),</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;illustrtaion_idelaized_pareto_front_radar_plot.png&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot an idelaized radar plot</span>

<span class="sd">    Args:</span>
<span class="sd">        min_value (float, optional): The minimum value for the plot. Defaults to 0.1.</span>
<span class="sd">        max_value (float, optional): The maximum value for the plot. Defaults to 1.0.</span>
<span class="sd">        objectives (Optional[List[str]]): List of objetcives to use</span>
<span class="sd">        filename (str, optional): file name to save to. Defaults to &quot;illustrtaion_idelaized_pareto_front_radar_plot.png&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Objective 1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Objective 6&quot;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">],</span>
            <span class="p">[</span><span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span> <span class="n">max_value</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">objectives</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">objectives</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">330</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_theta_direction</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">legend_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Illustrative Radar Pareto Front Plot</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">+</span> <span class="p">(</span><span class="n">min_value</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)],</span>
        <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_multi_radar_overlay">
    <p>def <span class="ident">plot_multi_radar_overlay</span>(</p><p>plot_df: pandas.core.frame.DataFrame, standard_plot_df: pandas.core.frame.DataFrame, y_ticks: List[float], y_labels: Optional[List[float]] = None, filename: str = &#39;multi_radar_with_standard.png&#39;, standard_label: Optional[str] = None, experimental_label: Optional[str] = None, legend_pos: Union[int, str] = &#39;best&#39;, standard_colour: str = &#39;b&#39;, experimental_colour: str = &#39;r&#39;, mols_per_row: int = 5, experimental_labels: Optional[List[str]] = None, standard_labels: Optional[List[str]] = None)</p>
    </div>




    <div class="desc"><p>Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules
(row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each  of the subplots as a coparison point that is consistent
over the sub plots.</p>
<p>Args:
    plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results
    standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.
    y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.
    y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.
    filename (str, optional): The filename to save the images to. Defaults to "radar_plot.png".
    standard_label (Optional[str], optional): Fixed label for the standard. Defaults to "Standard".
    experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to "Experimental".
    legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to "best".
    standard_colour (str, optional): The colour to use for the standard. Defaults to "b".
    experimental_colour (str, optional): The colour to use for the experimental data. Defaults to "r".
    mols_per_row: int: The number of molecule to plot in a sub plot row. Defaults to 5.
    experimental_label (Optional[str], optional): List of labels for each row (moleucle) of the experimantal dataframe. Defaults to None.
    standard_labels (Optional[str], optional): List of labels for each row (moleucle) of the standard dataframe. Defaults to None.</p>
<p>Returns:
    None</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_multi_radar_overlay', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_multi_radar_overlay" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_radar_overlay</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">standard_plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multi_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">experimental_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules</span>
<span class="sd">    (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each  of the subplots as a coparison point that is consistent</span>
<span class="sd">    over the sub plots.</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>
<span class="sd">        mols_per_row: int: The number of molecule to plot in a sub plot row. Defaults to 5.</span>
<span class="sd">        experimental_label (Optional[str], optional): List of labels for each row (moleucle) of the experimantal dataframe. Defaults to None.</span>
<span class="sd">        standard_labels (Optional[str], optional): List of labels for each row (moleucle) of the standard dataframe. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># base check that the columns are teh same length</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_number_of_columns</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># base check that the columns have the same names</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_column_names</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">n_rows</span><span class="p">,</span> <span class="n">m_columns</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_grid_layout</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span>
    <span class="p">)</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="c1">#### STANDARD PLOTTING</span>
        <span class="c1"># normalize item number values to colormap</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="c1"># Loop over the standards if there are multiple</span>
        <span class="k">for</span> <span class="n">jth</span><span class="p">,</span> <span class="n">standard_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">standard_idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">standard_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">standard_label</span> <span class="o">=</span> <span class="n">standard_labels</span><span class="p">[</span><span class="n">jth</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="c1"># colour map that should not overlap with Experimental red default</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">standard_colour</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">terrain</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">jth</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># For the title of the plot</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standards&quot;</span>

        <span class="c1">##### EXPERIMENTAL PLOTTING</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

        <span class="c1"># colour map that should not overlap with Experimental red default</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">experimental_colour</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">autumn</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">ith</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">experimental_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">experimental_labels</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">experimental_label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_label</span><span class="si">}</span><span class="s2"> Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_multi_radar_with_standard_data">
    <p>def <span class="ident">plot_multi_radar_with_standard_data</span>(</p><p>plot_df: pandas.core.frame.DataFrame, standard_plot_df: pandas.core.frame.DataFrame, y_ticks: List[float], y_labels: Optional[List[float]] = None, filename: str = &#39;multi_radar_with_standard.png&#39;, standard_label: Optional[str] = None, experimental_label: Optional[str] = None, legend_pos: Union[int, str] = &#39;best&#39;, standard_colour: str = &#39;b&#39;, experimental_colour: str = &#39;r&#39;, mols_per_row: int = 5, experimental_labels: Optional[List[str]] = None, standard_labels: Optional[List[str]] = None)</p>
    </div>




    <div class="desc"><p>Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules
(row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each  of the subplots as a coparison point that is consistent
over the sub plots.</p>
<p>Args:
    plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results
    standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.
    y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.
    y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.
    filename (str, optional): The filename to save the images to. Defaults to "radar_plot.png".
    standard_label (Optional[str], optional): Fixed label for the standard. Defaults to "Standard".
    experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to "Experimental".
    legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to "best".
    standard_colour (str, optional): The colour to use for the standard. Defaults to "b".
    experimental_colour (str, optional): The colour to use for the experimental data. Defaults to "r".
    mols_per_row: int: The number of molecule to plot in a sub plot row. Defaults to 5.
    experimental_label (Optional[str], optional): List of labels for each row (moleucle) of the experimantal dataframe. Defaults to None.
    standard_labels (Optional[str], optional): List of labels for each row (moleucle) of the standard dataframe. Defaults to None.</p>
<p>Returns:
    None</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_multi_radar_with_standard_data', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_multi_radar_with_standard_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_radar_with_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">standard_plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multi_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">experimental_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules</span>
<span class="sd">    (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each  of the subplots as a coparison point that is consistent</span>
<span class="sd">    over the sub plots.</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>
<span class="sd">        mols_per_row: int: The number of molecule to plot in a sub plot row. Defaults to 5.</span>
<span class="sd">        experimental_label (Optional[str], optional): List of labels for each row (moleucle) of the experimantal dataframe. Defaults to None.</span>
<span class="sd">        standard_labels (Optional[str], optional): List of labels for each row (moleucle) of the standard dataframe. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># base check that the columns are teh same length</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_number_of_columns</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># base check that the columns have the same names</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_column_names</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">n_rows</span><span class="p">,</span> <span class="n">m_columns</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_grid_layout</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span>
    <span class="p">)</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="c1">#### STANDARD PLOTTING</span>
        <span class="c1"># normalize item number values to colormap</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="c1"># Loop over the standards if there are multiple</span>
        <span class="k">for</span> <span class="n">jth</span><span class="p">,</span> <span class="n">standard_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">standard_idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">standard_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">standard_label</span> <span class="o">=</span> <span class="n">standard_labels</span><span class="p">[</span><span class="n">jth</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="c1"># colour map that should not overlap with Experimental red default</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">standard_colour</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">terrain</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">jth</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jth</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># For the title of the plot</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standards&quot;</span>

        <span class="c1">##### EXPERIMENTAL PLOTTING</span>
        <span class="k">if</span> <span class="n">experimental_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">experimental_labels</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">experimental_label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_label</span><span class="si">}</span><span class="s2"> Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_multi_radar_without_standard_data">
    <p>def <span class="ident">plot_multi_radar_without_standard_data</span>(</p><p>plot_df: pandas.core.frame.DataFrame, y_ticks: List[float], y_labels: Optional[List[float]] = None, filename: str = &#39;multi_radar_with_standard.png&#39;, experimental_label: Optional[str] = None, legend_pos: Union[int, str] = &#39;best&#39;, experimental_colour: str = &#39;r&#39;, mols_per_row: int = 5, experimental_labels: Optional[List[str]] = None)</p>
    </div>




    <div class="desc"><p>Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules
(row in df dataframe).</p>
<p>Args:
    plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results
    y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.
    y_labels (Optional[List[float]], optional): List of radial (y) ticks label values. Defaults to None.
    filename (str, optional): The filename to save the images to. Defaults to "radar_plot.png".
    experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to "Experimental".
    legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to "best".
    experimental_colour (str, optional): The colour to use for the experimental data. Defaults to "r".
    mols_per_row (int): The number of molecules to plot per row. Defaults to 5.
    experimental_label (Optional[str], optional): List of labels for each row (moleucle). Defaults to None.</p>
<p>Returns:
    None</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_multi_radar_without_standard_data', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_multi_radar_without_standard_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_multi_radar_without_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multi_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">experimental_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot of subplots one for each experimental molecules</span>
<span class="sd">    (row in df dataframe).</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_labels (Optional[List[float]], optional): List of radial (y) ticks label values. Defaults to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>
<span class="sd">        mols_per_row (int): The number of molecules to plot per row. Defaults to 5.</span>
<span class="sd">        experimental_label (Optional[str], optional): List of labels for each row (moleucle). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">n_rows</span><span class="p">,</span> <span class="n">m_columns</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_grid_layout</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span>
    <span class="p">)</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="c1">##### EXPERIMENTAL PLOTTING</span>
        <span class="k">if</span> <span class="n">experimental_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">experimental_labels</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">experimental_label</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="c1"># Now plot the Experimental molecule on one per sub plot</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_front">
    <p>def <span class="ident">plot_pareto_front</span>(</p><p>df: pandas.core.frame.DataFrame, minmax: List[str], objective_columns: Union[List[str], str] = &#39;all&#39;, label_column: Optional[str] = None, filename: Optional[str] = &#39;pareto_front.png&#39;, pareto_eff_col: Optional[str] = None, offset=0.02, summary_plot_type: Optional[str] = None, normalization: Optional[str] = &#39;zscale&#39;, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, consistent_scale: bool = True, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to plot a Pareto front in ND (Scatter plots for 2D and 3D)</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_column (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.
    summary_plot_type (Optional[str], optional): mean, min, max or None to plot a summary of the Pareto efficent set vs the Pareto inefficent set for N D optimzation. Defaults to None.
    normalization (Optional[str], optional): The normalization to use for ND radar plots. The 'zscale' is better for data where there are outliers as each dimension is normalized to unit variance,
    but each dimension has its own scale. The 'minmax' scaling places each dimesion on a normalized [0, 1] scale but maintains the skew of outliers. None uses raw data which can be hard to
    interpret when dimesnions have very different scales.
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings
    consistent_scale (bool): whether to use a consistent_scale for zscale axes on N dimensional radar plots, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to True.</p>
<p>Raises:
    RuntimeError: If a mismatched number of minmax and objective columns are provided
    UserWarning: If a user provides a singlar objective (i.e 1D) for which the Pareto solution is min(singular_objective_vect) or max(singular_objective_vect) and
    there is no need for using the Pareto method</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_front', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_front" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_front.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a Pareto front in ND (Scatter plots for 2D and 3D)</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_column (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        summary_plot_type (Optional[str], optional): mean, min, max or None to plot a summary of the Pareto efficent set vs the Pareto inefficent set for N D optimzation. Defaults to None.</span>
<span class="sd">        normalization (Optional[str], optional): The normalization to use for ND radar plots. The &#39;zscale&#39; is better for data where there are outliers as each dimension is normalized to unit variance,</span>
<span class="sd">        but each dimension has its own scale. The &#39;minmax&#39; scaling places each dimesion on a normalized [0, 1] scale but maintains the skew of outliers. None uses raw data which can be hard to</span>
<span class="sd">        interpret when dimesnions have very different scales.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes on N dimensional radar plots, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If a mismatched number of minmax and objective columns are provided</span>
<span class="sd">        UserWarning: If a user provides a singlar objective (i.e 1D) for which the Pareto solution is min(singular_objective_vect) or max(singular_objective_vect) and</span>
<span class="sd">        there is no need for using the Pareto method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ensure not adding to the original</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Use/assume the defualt name if none given</span>
    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make sure tehre is a pareto efficent column</span>
    <span class="k">if</span> <span class="n">par_eff_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Determining pareto efficent set as column not found in the currently passed in dataframe&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">get_pareto_efficient_set</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">minmax</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">return_efficent_set_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Pick the right plotting function</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 2D Pareto front&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_front_2d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 3D Pareto front&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_front_3d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">plot_pareto_front_nd</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">summary_plot_type</span><span class="o">=</span><span class="n">summary_plot_type</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">eff_eolutions_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
            <span class="s2">&quot;Number of objective columns is singular more than one objective should be used&quot;</span>
        <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_front_2d">
    <p>def <span class="ident">plot_pareto_front_2d</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], label_col: Optional[str] = None, filename: Optional[str] = None, pareto_eff_col: Optional[str] = None, offset: float = 0.02, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to save a 2D scatter plot for the Pareto front</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings</p>
<p>Returns:
    None: Save a plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_front_2d', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_front_2d" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front_2d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 2D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">par_eff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">par_ineff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto inefficent&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto efficent (optimal)&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns: </span><span class="si">{</span><span class="n">par_eff_df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Pareto optimal (efficent) set includes:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">label_col</span><span class="p">]):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> y: </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> lab: </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="n">lab</span><span class="p">,</span>
                <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Front&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">inchi</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_2d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_front_3d">
    <p>def <span class="ident">plot_pareto_front_3d</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], label_col: Optional[str] = None, filename: Optional[str] = None, pareto_eff_col: Optional[str] = None, offset: float = 0.02, xpad: int = 35, ypad: int = 40, zpad: int = 35, boxpad: float = 1.5, xlabwidth: int = 27, ylabwidth: int = 25, zlabwidth: int = 27, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to save a 3D scatter plot for the Pareto front</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings</p>
<p>Returns:
    None: Save a plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_front_3d', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_front_3d" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front_3d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="n">xpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">ypad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">zpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">boxpad</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="n">xlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">ylabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">zlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 3D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
    <span class="n">par_eff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">par_ineff_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_ineff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto inefficent&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto efficent (optimal)&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">xlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">ylabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">ypad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">zlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">zpad</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">par_eff_df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Pareto optimal (efficent) set includes:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">label_col</span><span class="p">]):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> y: </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> z: </span><span class="si">{</span><span class="n">z</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> lab: </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="n">ith</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">lab</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Front&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="n">boxpad</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">inchi</span><span class="o">=</span><span class="n">par_eff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_efficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
            <span class="n">smiles</span><span class="o">=</span><span class="n">par_ineff_df</span><span class="p">[</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;pareto_3d_inefficent.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_front_nd">
    <p>def <span class="ident">plot_pareto_front_nd</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], label_col: Optional[str] = None, filename: Optional[str] = &#39;pareto_nd.png&#39;, pareto_eff_col: Optional[str] = None, summary_plot_type: Optional[str] = &#39;mean&#39;, normalization: Optional[str] = &#39;zscale&#39;, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, consistent_scale: bool = False, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to plot an N dimensional pareto front on a radar plot. This is plotted by normalizeding all properties to a [0, 1] scale using min max normalization. Typically we summarize these by the mean, max or min of the inefficent set Vs the efficent set</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    summay_plot_type (Union[str, None], optional): the summary type mean, min or max of each objective for each set (inefficent and efficent). Defaults to "mean".
    normalization (Optional[str]): string name of normalization method or None to use raw data. Defaults to "zscale".
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings
    consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</p>
<p>Raises:
    UserWarning: if an unrecognized summary plot type is given</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_front_nd', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_front_nd" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_front_nd</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_nd.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot an N dimensional pareto front on a radar plot. This is plotted by normalizeding all properties to a [0, 1] scale using min max normalization. Typically we summarize these by the mean, max or min of the inefficent set Vs the efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        summay_plot_type (Union[str, None], optional): the summary type mean, min or max of each objective for each set (inefficent and efficent). Defaults to &quot;mean&quot;.</span>
<span class="sd">        normalization (Optional[str]): string name of normalization method or None to use raw data. Defaults to &quot;zscale&quot;.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserWarning: if an unrecognized summary plot type is given</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">summary_plot_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">summary_plot_df</span> <span class="o">=</span> <span class="n">radar_summary_plot</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">summary_type</span><span class="o">=</span><span class="n">summary_plot_type</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">summary_plot_df</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">radar_sub_plots_pareto_front</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">eff_eolutions_df</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_rank">
    <p>def <span class="ident">plot_pareto_rank</span>(</p><p>df: pandas.core.frame.DataFrame, minmax: List[str], objective_columns: Union[List[str], str] = &#39;all&#39;, label_column: Optional[str] = None, filename: Optional[str] = &#39;pareto_ranks.png&#39;, pareto_rank_col: Optional[str] = None, offset=0.02, colour_map=&#39;bwr_r&#39;, summary_plot_type: Optional[str] = None, normalization: Optional[str] = &#39;zscale&#39;, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, consistent_scale: bool = True, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to plot a Pareto front in ND (Scatter plots for 2D and 3D)</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_column (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_rank_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.
    summary_plot_type (Optional[str], optional): mean, min, max or None to plot a summary of the Pareto efficent set vs the Pareto inefficent set for N D optimzation. Defaults to None.
    normalization (Optional[str], optional): The normalization to use for ND radar plots. The 'zscale' is better for data where there are outliers as each dimension is normalized to unit variance,
    but each dimension has its own scale. The 'minmax' scaling places each dimesion on a normalized [0, 1] scale but maintains the skew of outliers. None uses raw data which can be hard to
    interpret when dimesnions have very different scales.
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings
    consistent_scale (bool): whether to use a consistent_scale for zscale axes on N dimensional radar plots, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to True.</p>
<p>Raises:
    RuntimeError: If a mismatched number of minmax and objective columns are provided
    UserWarning: If a user provides a singlar objective (i.e 1D) for which the Pareto solution is min(singular_objective_vect) or max(singular_objective_vect) and
    there is no need for using the Pareto method</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_rank', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_rank" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">minmax</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_ranks.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">colour_map</span><span class="o">=</span><span class="s2">&quot;bwr_r&quot;</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a Pareto front in ND (Scatter plots for 2D and 3D)</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        minmax (List[str]): list of optimal directions for the objective columns. Must be the same number of values as the number of objective columns</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_column (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_rank_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        summary_plot_type (Optional[str], optional): mean, min, max or None to plot a summary of the Pareto efficent set vs the Pareto inefficent set for N D optimzation. Defaults to None.</span>
<span class="sd">        normalization (Optional[str], optional): The normalization to use for ND radar plots. The &#39;zscale&#39; is better for data where there are outliers as each dimension is normalized to unit variance,</span>
<span class="sd">        but each dimension has its own scale. The &#39;minmax&#39; scaling places each dimesion on a normalized [0, 1] scale but maintains the skew of outliers. None uses raw data which can be hard to</span>
<span class="sd">        interpret when dimesnions have very different scales.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes on N dimensional radar plots, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If a mismatched number of minmax and objective columns are provided</span>
<span class="sd">        UserWarning: If a user provides a singlar objective (i.e 1D) for which the Pareto solution is min(singular_objective_vect) or max(singular_objective_vect) and</span>
<span class="sd">        there is no need for using the Pareto method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ensure not adding to the original</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Use/assume the defualt name if none given</span>
    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="c1"># Get the objetcive function columns if they are not explicitly defined</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># make sure the expected number of objetcive columns and minmax are there</span>
    <span class="k">if</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_lengths_same_two_lists</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">,</span> <span class="n">minmax</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of entries in the objetcive columns (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">) and minmax (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span><span class="si">}</span><span class="s2">) are different. These must be the same.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make sure tehre is a pareto efficent column</span>
    <span class="k">if</span> <span class="n">par_eff_col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Determining pareto ranks set as column not found in the currently passed in dataframe&quot;</span>
        <span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">get_pareto_ranking</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">minmax</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Pick the right plotting function</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 2D Pareto ranks&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_rank_2d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">colour_map</span><span class="o">=</span><span class="n">colour_map</span><span class="p">,</span>
            <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Plotting 3D Pareto ranks&quot;</span><span class="p">)</span>
        <span class="n">plot_pareto_rank_3d</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">colour_map</span><span class="o">=</span><span class="n">colour_map</span><span class="p">,</span>
            <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">plot_pareto_rank_nd</span><span class="p">(</span>
            <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_column</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
            <span class="n">summary_plot_type</span><span class="o">=</span><span class="n">summary_plot_type</span><span class="p">,</span>
            <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
            <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
            <span class="s2">&quot;Number of objective columns is singular more than one objective should be used&quot;</span>
        <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_rank_2d">
    <p>def <span class="ident">plot_pareto_rank_2d</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], label_col: Optional[str] = None, filename: Optional[str] = None, colour_map: Optional[str] = &#39;bwr_r&#39;, pareto_rank_col: Optional[str] = None, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to save a 2D scatter plot for the Pareto front</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_rank_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings</p>
<p>Returns:
    None: Save a plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_rank_2d', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_rank_2d" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank_2d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colour_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bwr_r&quot;</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 2D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_rank_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
        <span class="n">colormap</span><span class="o">=</span><span class="n">colour_map</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto Ranking&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Ranking&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_2d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_rank_3d">
    <p>def <span class="ident">plot_pareto_rank_3d</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], label_col: Optional[str] = None, filename: Optional[str] = None, pareto_rank_col: Optional[str] = None, colour_map: Optional[str] = &#39;bwr_r&#39;, xpad: int = 35, ypad: int = 40, zpad: int = 35, boxpad: float = 1.5, xlabwidth: int = 27, ylabwidth: int = 25, zlabwidth: int = 27, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to save a 3D scatter plot for the Pareto front</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings</p>
<p>Returns:
    None: Save a plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_rank_3d', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_rank_3d" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank_3d</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">colour_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bwr_r&quot;</span><span class="p">,</span>
    <span class="n">xpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">ypad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">zpad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
    <span class="n">boxpad</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="n">xlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">ylabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">zlabwidth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to save a 3D scatter plot for the Pareto front</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        offset (float, optional): x and y offset in image units from the point for the labels and arrows. Defaults to 0.02.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Save a plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colour_map</span><span class="p">)</span>
    <span class="n">cmap_norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">scalable_cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">cmap_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">scalable_cmap</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pareto ranking&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">xlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">ylabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">ypad</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="n">zlabwidth</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">labelpad</span><span class="o">=</span><span class="n">zpad</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Ranking&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="n">boxpad</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span>
                        <span class="n">smiles_column</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rank</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unqiue</span><span class="p">():</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">_3d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">rank</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_pareto_rank_nd">
    <p>def <span class="ident">plot_pareto_rank_nd</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], label_col: Optional[str] = None, filename: Optional[str] = &#39;pareto_nd.png&#39;, pareto_rank_col: Optional[str] = None, summary_plot_type: Optional[str] = &#39;mean&#39;, normalization: Optional[str] = &#39;zscale&#39;, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, consistent_scale: bool = False, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to plot an N dimensional pareto front on a radar plot. This is plotted by normalizeding all properties to a [0, 1] scale using min max normalization. Typically we summarize these by the mean, max or min of the inefficent set Vs the efficent set</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    summay_plot_type (Union[str, None], optional): the summary type mean, min or max of each objective for each set (inefficent and efficent). Defaults to "mean".
    normalization (Optional[str]): string name of normalization method or None to use raw data. Defaults to "zscale".
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings
    consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</p>
<p>Raises:
    UserWarning: if an unrecognized summary plot type is given</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_pareto_rank_nd', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_pareto_rank_nd" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_pareto_rank_nd</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pareto_nd.png&quot;</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">summary_plot_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot an N dimensional pareto front on a radar plot. This is plotted by normalizeding all properties to a [0, 1] scale using min max normalization. Typically we summarize these by the mean, max or min of the inefficent set Vs the efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): column header for the column that conatins the molecule labels. If not given no label annotation will be on the plot. Defaults to None.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        summay_plot_type (Union[str, None], optional): the summary type mean, min or max of each objective for each set (inefficent and efficent). Defaults to &quot;mean&quot;.</span>
<span class="sd">        normalization (Optional[str]): string name of normalization method or None to use raw data. Defaults to &quot;zscale&quot;.</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserWarning: if an unrecognized summary plot type is given</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">radar_sub_plots_pareto_ranking</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span>
        <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">,</span>
        <span class="n">pareto_rank_col</span><span class="o">=</span><span class="n">pareto_rank_col</span><span class="p">,</span>
        <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span>
        <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
        <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
        <span class="n">consistent_scale</span><span class="o">=</span><span class="n">consistent_scale</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_single_radar_with_standard_data">
    <p>def <span class="ident">plot_single_radar_with_standard_data</span>(</p><p>plot_df: pandas.core.frame.DataFrame, standard_plot_df: pandas.core.frame.DataFrame, y_ticks: Optional[List[float]] = None, y_labels: Optional[List[float]] = None, filename: str = &#39;single_radar_with_standard.png&#39;, standard_label: str = &#39;Standard&#39;, experimental_label: str = &#39;Experimental&#39;, legend_pos: Union[int, str] = &#39;best&#39;, standard_colour: str = &#39;b&#39;, experimental_colour: str = &#39;r&#39;)</p>
    </div>




    <div class="desc"><p>Function to plot Radar plots directly on the provided data. This funtion will make a single plot for a single experimental and standard
datapoint i.e. will only plot the first row of the experimental and standard dataframes</p>
<p>Args:
    plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results
    standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.
    y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.
    y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.
    filename (str, optional): The filename to save the images to. Defaults to "radar_plot.png".
    standard_label (Optional[str], optional): Fixed label for the standard. Defaults to "Standard".
    experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to "Experimental".
    legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to "best".
    standard_colour (str, optional): The colour to use for the standard. Defaults to "b".
    experimental_colour (str, optional): The colour to use for the experimental data. Defaults to "r".</p>
<p>Returns:
    None</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_single_radar_with_standard_data', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_single_radar_with_standard_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_single_radar_with_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">standard_plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;single_radar_with_standard.png&quot;</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot for a single experimental and standard</span>
<span class="sd">    datapoint i.e. will only plot the first row of the experimental and standard dataframes</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        standard_plot_df (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_label (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># base check that the columns are teh same length</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_number_of_columns</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># base check that the columns have the same names</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">check_dfs_have_the_same_column_names</span><span class="p">(</span>
        <span class="n">plot_df</span><span class="p">,</span> <span class="n">standard_plot_df</span><span class="p">,</span> <span class="n">df1_name</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">,</span> <span class="n">df2_name</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="o">+</span> <span class="p">[</span><span class="n">standard_plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_label</span><span class="si">}</span><span class="s2"> Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">y_labels</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.plot_single_radar_without_standard_data">
    <p>def <span class="ident">plot_single_radar_without_standard_data</span>(</p><p>plot_df: pandas.core.frame.DataFrame, y_ticks: List[float], y_labels: Optional[List[float]] = None, filename: str = &#39;single_radar_without_standard.png&#39;, experimental_label: str = &#39;Experimental&#39;, legend_pos: Union[int, str] = &#39;best&#39;, experimental_colour: str = &#39;r&#39;)</p>
    </div>




    <div class="desc"><p>Function to plot Radar plots directly on the provided data. This funtion will make a single plot for a single experimental
datapoint i.e. will only plot the first row of the experimental dataframes</p>
<p>Args:
    plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results
    y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.
    y_labels (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.
    filename (str, optional): The filename to save the images to. Defaults to "radar_plot.png".
    experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to "Experimental".
    legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to "best".
    experimental_colour (str, optional): The colour to use for the experimental data. Defaults to "r".</p>
<p>Returns:
    None</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.plot_single_radar_without_standard_data', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.plot_single_radar_without_standard_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_single_radar_without_standard_data</span><span class="p">(</span>
    <span class="n">plot_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">y_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;single_radar_without_standard.png&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. This funtion will make a single plot for a single experimental</span>
<span class="sd">    datapoint i.e. will only plot the first row of the experimental dataframes</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        y_labels (Optional[List[float]], optional): List of y (radial) tick labels to display. Defualts to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">})</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">experimental_label</span><span class="si">}</span><span class="s2"> Radar Plot&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
            <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">y_labels</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.radar_plot">
    <p>def <span class="ident">radar_plot</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: Optional[List[Union[int, str]]] = None, df_standard: Optional[pandas.core.frame.DataFrame] = None, standard_unique_identifier: Optional[str] = None, standard_unique_identifer_column: Optional[str] = None, y_ticks: Optional[list] = None, filename: str = &#39;radar_plot.png&#39;, label_column: Union[str, int, NoneType] = None, standard_label: Optional[str] = &#39;Standard&#39;, experimental_label: Optional[str] = &#39;Experimental&#39;, legend_pos: Union[int, str] = &#39;best&#39;, show_y_ticks: bool = False, standard_colour: str = &#39;b&#39;, experimental_colour: str = &#39;r&#39;, **kwargs)</p>
    </div>




    <div class="desc"><p>Function to plot Radar plots directly on the provided data. There is no automated scaling in this function as in the analysis based functions above
this is just to plot the data. Having this separated allows for flexibility in plotting for example MMP series. This funtion will make a single plot
of subplots one for each experimental molecules (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each
of the subplots as a coparison point that is consistent over the sub plots.</p>
<p>Args:
    df (pd.DataFrame): Dataframe to use for plotting query/experimental results
    objective_columns (Optional[List[str, int]], optional): The columns to use as the objectives if not given assumes all columns are objective columns. Defaults to None.
    df_standard (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.
    standard_unique_identifier (Optional[str], optional): Column name in standard dataframe to identify a molecule. Defaults to None.
    standard_unique_identifer_column (Optional[str], optional): Column name in experimental dataframe to identify a molecule. Defaults to None.
    y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.
    filename (str, optional): The filename to save the images to. Defaults to "radar_plot.png".
    label_column (Optional[Union[str, int]], optional): Column name in experimental and standard  dataframe to give a label a molecule. Defaults to None.
    standard_label (Optional[str], optional): Fixed label for the standard. Defaults to "Standard".
    experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to "Experimental".
    legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to "best".
    show_y_ticks (bool, optional): Bool True show the radial y_tick values False don't show them. Defaults to False.
    standard_colour (str, optional): The colour to use for the standard. Defaults to "b".
    experimental_colour (str, optional): The colour to use for the experimental data. Defaults to "r".</p>
<p>Returns:
    None</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.radar_plot', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.radar_plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">radar_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">df_standard</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_unique_identifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_unique_identifer_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;radar_plot.png&quot;</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">standard_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">,</span>
    <span class="n">experimental_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">show_y_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">standard_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">experimental_colour</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot Radar plots directly on the provided data. There is no automated scaling in this function as in the analysis based functions above</span>
<span class="sd">    this is just to plot the data. Having this separated allows for flexibility in plotting for example MMP series. This funtion will make a single plot</span>
<span class="sd">    of subplots one for each experimental molecules (row in df dataframe) and will plot the standards dataframe, if it is avaliable, row(s) on each</span>
<span class="sd">    of the subplots as a coparison point that is consistent over the sub plots.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Dataframe to use for plotting query/experimental results</span>
<span class="sd">        objective_columns (Optional[List[str, int]], optional): The columns to use as the objectives if not given assumes all columns are objective columns. Defaults to None.</span>
<span class="sd">        df_standard (Optional[pd.DataFrame], optional): Dataframe to use as standard data for comparing the experimenatl data to. Defaults to None.</span>
<span class="sd">        standard_unique_identifier (Optional[str], optional): Column name in standard dataframe to identify a molecule. Defaults to None.</span>
<span class="sd">        standard_unique_identifer_column (Optional[str], optional): Column name in experimental dataframe to identify a molecule. Defaults to None.</span>
<span class="sd">        y_ticks (Optional[list], optional): The y tick marks to use if you want the radial scales to match other plots. Defaults to None.</span>
<span class="sd">        filename (str, optional): The filename to save the images to. Defaults to &quot;radar_plot.png&quot;.</span>
<span class="sd">        label_column (Optional[Union[str, int]], optional): Column name in experimental and standard  dataframe to give a label a molecule. Defaults to None.</span>
<span class="sd">        standard_label (Optional[str], optional): Fixed label for the standard. Defaults to &quot;Standard&quot;.</span>
<span class="sd">        experimental_label (Optional[str], optional): Fixed label for the experimental. Defaults to &quot;Experimental&quot;.</span>
<span class="sd">        legend_pos (Union[int, str], optional): position of the legend on the plot. Defaults to &quot;best&quot;.</span>
<span class="sd">        show_y_ticks (bool, optional): Bool True show the radial y_tick values False don&#39;t show them. Defaults to False.</span>
<span class="sd">        standard_colour (str, optional): The colour to use for the standard. Defaults to &quot;b&quot;.</span>
<span class="sd">        experimental_colour (str, optional): The colour to use for the experimental data. Defaults to &quot;r&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If objective columns is None not given assume all query/experimental columns are objective columns</span>
    <span class="k">if</span> <span class="n">objective_columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objective_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Get the standard data if there is standard data and extract the objective columns for plotting</span>
    <span class="c1"># if there is a stanard df provoided</span>
    <span class="k">if</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using standard data frame</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}{</span><span class="n">df_standard</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">standard_plot_df</span> <span class="o">=</span> <span class="n">df_standard</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span>

    <span class="c1"># if the standard data need to be taken out of a dataframe</span>
    <span class="k">elif</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">standard_unique_identifer_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If the standard data is part of the main data frame copy it and delete it</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">df_standard</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">extract_and_remove_row_from_df</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">standard_unique_identifer_column</span><span class="o">=</span><span class="n">standard_unique_identifer_column</span><span class="p">,</span>
            <span class="n">standard_unique_identifier</span><span class="o">=</span><span class="n">standard_unique_identifier</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using row from main df as the standard </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="si">}{</span><span class="n">df_standard</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">standard_plot_df</span> <span class="o">=</span> <span class="n">df_standard</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span>
    <span class="c1"># if there is no standard data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No standard provided will plot just the objective functions&quot;</span><span class="p">)</span>
        <span class="n">standard_plot_df</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Get the plot data for the experimental points</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">label_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">label_column</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="n">df_standard</span><span class="p">[</span><span class="n">label_column</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># set the y ticks if they are not given</span>
    <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="nb">min</span><span class="p">(</span>
                <span class="n">df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="p">),</span>
            <span class="nb">max</span><span class="p">(</span>
                <span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="n">standard_plot_df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="p">),</span>
            <span class="mi">5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">standard_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span>
        <span class="k">if</span> <span class="n">experimental_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span>

        <span class="k">if</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_single_radar_with_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">standard_label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">standard_colour</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_single_radar_without_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">standard_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">standard_label</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span>
        <span class="k">if</span> <span class="n">experimental_label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">experimental_label</span> <span class="o">=</span> <span class="s2">&quot;Experimental&quot;</span>

        <span class="k">if</span> <span class="n">df_standard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_multi_radar_with_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">standard_plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">standard_label</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">standard_colour</span><span class="o">=</span><span class="n">standard_colour</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="n">experimental_labels</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">standard_labels</span><span class="o">=</span><span class="n">standard_label</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_multi_radar_without_standard_data</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">y_ticks</span><span class="o">=</span><span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="o">=</span><span class="n">y_labels</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">experimental_label</span><span class="o">=</span><span class="n">experimental_label</span><span class="p">,</span>
                <span class="n">legend_pos</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span>
                <span class="n">experimental_colour</span><span class="o">=</span><span class="n">experimental_colour</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.radar_sub_plots_pareto_front">
    <p>def <span class="ident">radar_sub_plots_pareto_front</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], filename: Optional[str] = &#39;subplot_pareto.png&#39;, label_col: Optional[str] = None, pareto_eff_col: Optional[str] = None, normalization: Optional[str] = &#39;zscale&#39;, legend_pos: str = &#39;best&#39;, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, consistent_scale: bool = False, mols_per_row: int = 5, return_data: bool = True, y_ticks: Union[numpy.ndarray, list, NoneType] = None, show_y_ticks: bool = False)</p>
    </div>




    <div class="desc"><p>Function to plot a radar plot of the normalized (min max normalization) mean for each property over the inefficent and efficent set</p>
<p>Args:
    ddf (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    label_col (Optional[str], optional): The column that defines the molecules labels.
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    normalization (Union[str, None]): string defining teh normalization method
    legend_pos (str): legend position string for matplotlib
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings
    consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.
    y_ticks (Optional[Union[np.ndarray, list]], optional): Set of y ticks to use to allow for comparison across sets. Defaults as None.</p>
<p>Returns:
    None: saves plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.radar_sub_plots_pareto_front', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.radar_sub_plots_pareto_front" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">radar_sub_plots_pareto_front</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;subplot_pareto.png&quot;</span><span class="p">,</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">return_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_y_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a radar plot of the normalized (min max normalization) mean for each property over the inefficent and efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        ddf (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): The column that defines the molecules labels.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        normalization (Union[str, None]): string defining teh normalization method</span>
<span class="sd">        legend_pos (str): legend position string for matplotlib</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>
<span class="sd">        y_ticks (Optional[Union[np.ndarray, list]], optional): Set of y ticks to use to allow for comparison across sets. Defaults as None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: saves plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set the column containing the Pareto efficent labels as bools</span>
    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Assuming Pareto efficent bool column is </span><span class="si">{</span><span class="n">par_eff_col_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataframe input has shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get the metric columns only and normalize as requested</span>
    <span class="n">metric_assay_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># min max scale</span>
        <span class="k">if</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Min max scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_min_max_scale</span><span class="p">(</span>
                <span class="n">metric_assay_df</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min max scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

        <span class="c1"># z scale</span>
        <span class="k">elif</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;zscale&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Z scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_z_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consistent_scale</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before scaling the data frame is </span><span class="si">{</span><span class="n">metric_assay_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;After scaling the data frame is </span><span class="si">{</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                        <span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto (z) scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="c1"># No scaling - ill advised</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Will not scale data within this method. You should pre-scale your data.&quot;</span>
        <span class="p">)</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">metric_assay_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unscaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># get whether a molecule is an efficent solution</span>
    <span class="n">efficent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">efficent</span><span class="p">)</span><span class="si">}</span><span class="s2"> Pareto efficent solutions in the input data&quot;</span><span class="p">)</span>

    <span class="c1"># Get the mean of the Pareto inefficent solutions as a background</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="c1"># Get the normalized efficent solutions one per row</span>
    <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">])</span>

    <span class="c1"># set the layout assuming 5 columns asa default</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mols_per_row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mols_per_row</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">m_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">%</span> <span class="n">mols_per_row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span>
        <span class="n">m_columns</span> <span class="o">=</span> <span class="n">mols_per_row</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span><span class="p">))</span>
        <span class="n">m_columns</span> <span class="o">=</span> <span class="n">mols_per_row</span>

    <span class="c1"># Set the overall figure</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
    <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">label_col</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ith</span><span class="p">)</span>

        <span class="c1"># plot mean of inefficent set as the background</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Inefficent set mean&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># plot the efficent row example</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Efficent solution </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="n">theta</span><span class="p">,</span>
            <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Inefficent Vs.</span><span class="se">\n</span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
            <span class="n">y_ticks</span><span class="p">,</span>
            <span class="n">y_labels</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># save the plot and tidy up</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="c1"># for if structures are given as smiles or inchi</span>
        <span class="n">efficent_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;efficent_molecules_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d_</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">inefficent_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;inefficent_molecules_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d_</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the smiles from is </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the smiles from columns are </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Efficent molecules images in file </span><span class="si">{</span><span class="n">efficent_filename</span><span class="si">}</span><span class="s2"> inefficent molecules images in file </span><span class="si">{</span><span class="n">inefficent_filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the inchi from is </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data frame to get the inchi from columns are </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Efficent molecules images in file </span><span class="si">{</span><span class="n">efficent_filename</span><span class="si">}</span><span class="s2"> inefficent molecules images in file </span><span class="si">{</span><span class="n">inefficent_filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">efficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">inefficent_filename</span><span class="p">,</span>
                <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">eff_eolutions_df</span> <span class="o">=</span> <span class="n">_get_radar_subplot_data</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">objective_columns</span><span class="o">=</span><span class="n">objective_columns</span><span class="p">,</span>
            <span class="n">label_col</span><span class="o">=</span><span class="n">label_col</span><span class="p">,</span>
            <span class="n">pareto_eff_col</span><span class="o">=</span><span class="n">pareto_eff_col</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">inchi_column</span><span class="o">=</span><span class="n">inchi_column</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">eff_eolutions_df</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.radar_sub_plots_pareto_ranking">
    <p>def <span class="ident">radar_sub_plots_pareto_ranking</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], filename: Optional[str] = &#39;subplot_pareto_ranks.png&#39;, label_col: Optional[str] = None, pareto_rank_col: Optional[str] = None, normalization: Optional[str] = &#39;zscale&#39;, legend_pos: str = &#39;best&#39;, smiles_column: Optional[str] = None, inchi_column: Optional[str] = None, consistent_scale: bool = False, mols_per_row: int = 5)</p>
    </div>




    <div class="desc"><p>Function to plot a radar plot of the normalized (zscale) mean for each property over the inefficent and the values for each molecule</p>
<p>Args:
    ddf (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    filename (Optional[str], optional): The file to save the plot to. Defaults to "subplot_pareto_ranks.png".
    label_col (Optional[str], optional): The column that defines the molecules labels.
    pareto_rank_col (Optional[str], optional): column header for the column that defines a molecules Pareto rank (int column). Defaults to None.
    normalization (Union[str, None]): string defining teh normalization method
    legend_pos (str): legend position string for matplotlib
    smiles_column (str, optional): the column that contains smiles strings
    inchi_column (str, optional): the column that contains inchi strings
    consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</p>
<p>Returns:
    None: saves plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.radar_sub_plots_pareto_ranking', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.radar_sub_plots_pareto_ranking" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">radar_sub_plots_pareto_ranking</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;subplot_pareto_ranks.png&quot;</span><span class="p">,</span>
    <span class="n">label_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_rank_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inchi_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mols_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a radar plot of the normalized (zscale) mean for each property over the inefficent and the values for each molecule</span>

<span class="sd">    Args:</span>
<span class="sd">        ddf (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;subplot_pareto_ranks.png&quot;.</span>
<span class="sd">        label_col (Optional[str], optional): The column that defines the molecules labels.</span>
<span class="sd">        pareto_rank_col (Optional[str], optional): column header for the column that defines a molecules Pareto rank (int column). Defaults to None.</span>
<span class="sd">        normalization (Union[str, None]): string defining teh normalization method</span>
<span class="sd">        legend_pos (str): legend position string for matplotlib</span>
<span class="sd">        smiles_column (str, optional): the column that contains smiles strings</span>
<span class="sd">        inchi_column (str, optional): the column that contains inchi strings</span>
<span class="sd">        consistent_scale (bool): whether to use a consistent_scale for zscale axes, these will be the min and max values over the entire dataframe which may make some small changes hard to visualize. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: saves plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set teh column containing the Pareto efficent labels as bools</span>
    <span class="k">if</span> <span class="n">pareto_rank_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Assuming Pareto rank int column is </span><span class="si">{</span><span class="n">par_rank_col_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pareto_rank_col</span> <span class="o">=</span> <span class="n">par_rank_col_name</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataframe input has shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set the number of objectives and the convert to polar angles</span>
    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get the metric columns only and normalize as requested</span>
    <span class="n">metric_assay_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># min max scale</span>
        <span class="k">if</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Min max scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_rank_df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_min_max_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
        <span class="c1"># z scale</span>
        <span class="k">elif</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;zscale&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Z scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_rank_df</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_z_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consistent_scale</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before scaling the data frame is </span><span class="si">{</span><span class="n">metric_assay_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After scaling the data frame is </span><span class="si">{</span><span class="n">pareto_rank_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">pareto_rank_df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">pareto_rank_df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># [f&quot;{ent:.2f}&quot; for ent in y_ticks]</span>

    <span class="c1"># No scaling - ill advised</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Using un-normalized property values&quot;</span><span class="p">)</span>
        <span class="n">pareto_rank_df</span> <span class="o">=</span> <span class="n">metric_assay_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="c1"># At the end of this:</span>
    <span class="c1">#   df is the raw input dataframe</span>
    <span class="c1">#   metric_assay_df is a copy of the same dataframe but a subset of the columns i.e. only the objective columns</span>
    <span class="c1">#   pareto_rank_df is a copy of the metric_assay dataframe but scaled values</span>

    <span class="c1"># Get the mean of the Pareto inefficent solutions (those with a rank over 1) as a background</span>
    <span class="c1"># log.info(df.dtypes)</span>
    <span class="c1"># log.info(df)</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">pareto_rank_df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">][</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="c1"># loop over the unique classes of the Pareto ranking an make a figure for each</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mols_per_row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mols_per_row</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of chosen df: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># set the layout assuming 5 columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">mols_per_row</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There&#39;re less than </span><span class="si">{</span><span class="n">mols_per_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">m_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">%</span> <span class="n">mols_per_row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There&#39;re are a multiple of </span><span class="si">{</span><span class="n">mols_per_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span>
            <span class="n">m_columns</span> <span class="o">=</span> <span class="mi">5</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There&#39;re are not a multiple of </span><span class="si">{</span><span class="n">mols_per_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">/</span> <span class="n">mols_per_row</span><span class="p">))</span>
            <span class="n">m_columns</span> <span class="o">=</span> <span class="n">mols_per_row</span>

        <span class="c1"># Set the overall figure per group</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">m_columns</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;for Pareto ranking </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2"> there are n rows: </span><span class="si">{</span><span class="n">n_rows</span><span class="si">}</span><span class="s2"> m columns: </span><span class="si">{</span><span class="n">m_columns</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pareto_rank_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># log.info(chosen_df)</span>

        <span class="c1"># loop over the rows and create a subplot per row using the mean of the inefficent set as a background for comparison</span>
        <span class="k">for</span> <span class="n">ith</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Row </span><span class="si">{</span><span class="n">ith</span><span class="si">}</span><span class="s2">: N rows: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)</span><span class="si">}</span><span class="s2"> M columns: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> Plot ith: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">ith</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m_columns</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">ith</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lab</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">label_col</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lab</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ith</span><span class="p">)</span>

            <span class="c1"># plot mean of inefficent set as the background</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Inefficent set mean&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># plot the efficent row example</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rank </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2"> solution </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">,</span>
                <span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">chosen_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ith</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Inefficent Vs.</span><span class="se">\n</span><span class="s2">Rank </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                    <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span>
                    <span class="n">width</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                    <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
                <span class="n">y_ticks</span><span class="p">,</span>
                <span class="n">y_labels</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># save the plot and tidy up</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">h_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">savep</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">savep</span><span class="o">.</span><span class="n">stem</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">savep</span><span class="o">.</span><span class="n">suffix</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">smiles</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">smiles_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">inchi_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">label_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vis</span><span class="o">.</span><span class="n">draw_aligned_mol_grid</span><span class="p">(</span>
                    <span class="n">inchi</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">inchi_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;pareto_rank_</span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_obj</span><span class="si">}</span><span class="s2">d.png&quot;</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">pareto_rank_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">pr</span><span class="p">][</span><span class="n">label_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="n">mols_per_row</span><span class="o">=</span><span class="n">mols_per_row</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not smiles or inchi column so cannot plot chemical structures&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>


  <div class="item">
    <div class="name def" id="chemutil.multiopt.radar_summary_plot">
    <p>def <span class="ident">radar_summary_plot</span>(</p><p>df: pandas.core.frame.DataFrame, objective_columns: List[str], normalization: Optional[str] = &#39;zscale&#39;, summary_type: str = &#39;mean&#39;, consistent_scale: bool = True, filename: Optional[str] = None, pareto_eff_col: Optional[str] = None, y_ticks: Union[numpy.ndarray, List[float], NoneType] = None, show_y_ticks: bool = False, legend_pos: Union[int, str] = 0)</p>
    </div>




    <div class="desc"><p>Function to plot a radar plot of the normalized data using one of mean, median, max or min summary methods for each property over the inefficent and efficent set</p>
<p>Args:
    df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the <code>label_column</code> or <code>pareto_eff_col</code> are set then it should also contain these.
    objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if 'all' it uses all provided columns as the objective columns. Defaults to "all".
    normalization (Union[str, None]): The normalization type to use or None to use the raw data. Default is zscale.
    summary_type (str): the type of summary statistic to use out of mean. median, max and min. Default is mean.
    filename (Optional[str], optional): The file to save the plot to. Defaults to "pareto_front.png".
    pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.
    y_ticks (Optional[Union[np.ndarray, List[float]]], optional): Defined set of y tickmarks values to use
    show_y_ticks (bool): Show z scaled y values. Default is False
    legend_pos: (Union[int, str]): where to put the legend see https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html. Defaults to 0 best.</p>
<p>Returns:
    None: saves plot to file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-chemutil.multiopt.radar_summary_plot', this);">Show source &equiv;</a></p>
  <div id="source-chemutil.multiopt.radar_summary_plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">radar_summary_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objective_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
    <span class="n">summary_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">consistent_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pareto_eff_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_ticks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_y_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">legend_pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a radar plot of the normalized data using one of mean, median, max or min summary methods for each property over the inefficent and efficent set</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame that conatins at least the objective columns (can contain more). If the `label_column` or `pareto_eff_col` are set then it should also contain these.</span>
<span class="sd">        objective_columns (Union[List[str], str], optional): The column headers for the objetcive columns, if &#39;all&#39; it uses all provided columns as the objective columns. Defaults to &quot;all&quot;.</span>
<span class="sd">        normalization (Union[str, None]): The normalization type to use or None to use the raw data. Default is zscale.</span>
<span class="sd">        summary_type (str): the type of summary statistic to use out of mean. median, max and min. Default is mean.</span>
<span class="sd">        filename (Optional[str], optional): The file to save the plot to. Defaults to &quot;pareto_front.png&quot;.</span>
<span class="sd">        pareto_eff_col (Optional[str], optional): column header for the column that defines whether a molecule is in the Pareto efficent set (boolean column). Defaults to None.</span>
<span class="sd">        y_ticks (Optional[Union[np.ndarray, List[float]]], optional): Defined set of y tickmarks values to use</span>
<span class="sd">        show_y_ticks (bool): Show z scaled y values. Default is False</span>
<span class="sd">        legend_pos: (Union[int, str]): where to put the legend see https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html. Defaults to 0 best.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: saves plot to file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">pareto_eff_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_eff_col</span> <span class="o">=</span> <span class="n">par_eff_col_name</span>

    <span class="n">n_obj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_columns</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_obj</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get the metric columns only and normalize as requested</span>
    <span class="n">metric_assay_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">objective_columns</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># min max scale</span>
        <span class="k">if</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Min max scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_min_max_scale</span><span class="p">(</span>
                <span class="n">metric_assay_df</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min max scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>
        <span class="c1"># z scale</span>
        <span class="k">elif</span> <span class="n">normalization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;zscale&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Z scaling&quot;</span><span class="p">)</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">pandas_df_z_scale</span><span class="p">(</span><span class="n">metric_assay_df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">consistent_scale</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before scaling the data frame is </span><span class="si">{</span><span class="n">metric_assay_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;After scaling the data frame is </span><span class="si">{</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                        <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                        <span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto (z) scaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="c1"># No scaling - ill advised</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Will not perform scaling within the function. You should pre-scale your data.&quot;</span>
        <span class="p">)</span>
        <span class="n">pareto_eff_set_in_nd_df_normed</span> <span class="o">=</span> <span class="n">metric_assay_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">y_ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="p">),</span>
                <span class="nb">max</span><span class="p">(</span><span class="n">pareto_eff_set_in_nd_df_normed</span><span class="p">),</span>
                <span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unscaled y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_y_ticks</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">]</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Y ticks </span><span class="si">{</span><span class="n">y_ticks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">efficent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pareto_eff_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;median&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">summary_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
        <span class="n">background_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">chosen_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">pareto_eff_set_in_nd_df_normed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">efficent</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">background_df</span><span class="p">,</span> <span class="n">chosen_df</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unknown summary type &#39;</span><span class="si">{</span><span class="n">summary_type</span><span class="si">}</span><span class="s2">&#39; (type is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">summary_type</span><span class="p">)</span><span class="si">}</span><span class="s2">), please give one of: &#39;mean&#39;, &#39;median&#39;, &#39;min&#39; or &#39;max&#39;&quot;</span>
        <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;polar&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Inefficent set </span><span class="si">{</span><span class="n">summary_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Efficent set </span><span class="si">{</span><span class="n">summary_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">theta</span><span class="p">,</span>
        <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_pos</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Inefficent Set Vs. </span><span class="si">{</span><span class="n">summary_type</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> Efficent Set&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">27</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axes_labs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)),</span> <span class="n">width</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">axes_labs</span> <span class="o">+</span> <span class="p">[</span><span class="n">axes_labs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
        <span class="n">y_ticks</span><span class="p">,</span>
        <span class="n">y_labels</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">plot_df</span>
</pre></div>

  </div>
</div>

  </div>



  </section>
</article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Generated by <a href="https://github.com/timothycrosley/pdocs">pdocs 1.2.0</a>
    </p>
  </footer>
</div>
</body>
</html>
